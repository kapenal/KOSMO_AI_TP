<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>검색 결과</title>
    <script>
        // 페이지 로드 시 search_text을 받아서 input에 넣어주기
        window.onload = function () {
            const urlParams = new URLSearchParams(window.location.search);
            const encodedMovieData = urlParams.get('search_movie');

            console.log("📦 인코딩된 데이터:", encodedMovieData);

            if (encodedMovieData) {
                try {
                    const movieData = JSON.parse(decodeURIComponent(encodedMovieData));

                    if (Array.isArray(movieData)) {
                        // 영화 리스트일 경우 출력
                        movieData.forEach(movie => {
                            console.log("🎬 제목:", movie.제목);
                            // HTML에 출력
                            document.getElementById('search_text').value = movie.제목;
                        });
                    } else if (movieData.message) {
                        // 에러 메시지 출력
                        console.log("❌ 메시지:", movieData.message);
                        document.getElementById("result").innerText = movieData.message;
                    } else {
                        console.log("⚠️ 예상하지 못한 데이터 구조:", movieData);
                    }

                } catch (e) {
                    console.error("❌ JSON 파싱 오류:", e);
                }
            } else {
                console.log("⚠️ search_movie 파라미터가 없습니다.");
            }
        };

    </script>
</head>
<body>
    <div>
        <h1>Search Result Page</h1>
        <p>검색 <input type="text" id="search_text"></p>
        <button id="search_btn">검색</button>
        <button id="detail_btn">상세 페이지</button>
        <button id="list_btn">영화 랭킹 페이지</button>
    </div>
    <script src="../js/script.js"></script>
    <script src="../js/detail_page.js"></script>
    <script src="../js/list_page.js"></script>
</body>
</html>